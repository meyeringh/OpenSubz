(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{tI9I:function(e,t,i){"use strict";i.r(t),i.d(t,"TabOverviewPageModule",(function(){return G}));var n=i("TEn/"),r=i("ofXK"),o=i("3Pt+"),s=i("tyNb"),a=i("mrSG");const l=["YEARS","MONTHS","WEEKS","DAYS"],c=["BLUE","GREEN","YELLOW","RED","GREY"];var b=i("fXoL"),u=i("8znc"),d=i("sYmb");const m=["nameInput"];function p(e,t){1&e&&(b.Kb(0),b.mc(1),b.Xb(2,"translate"),b.Jb()),2&e&&(b.xb(1),b.nc(b.Yb(2,1,"TABS.OVERVIEW.ADD_SUBSCRIPTION")))}function h(e,t){1&e&&(b.mc(0),b.Xb(1,"translate")),2&e&&b.nc(b.Yb(1,1,"TABS.OVERVIEW.UPDATE_SUBSCRIPTION"))}function g(e,t){if(1&e&&(b.Kb(0),b.Mb(1,"ion-select-option",33),b.mc(2),b.Xb(3,"translate"),b.Xb(4,"uppercase"),b.Lb(),b.Jb()),2&e){const e=t.$implicit;b.xb(1),b.dc("value",e),b.xb(1),b.nc(b.Yb(3,2,b.Yb(4,4,"TABS.OVERVIEW.COLORS."+e)))}}function E(e,t){if(1&e&&(b.Kb(0),b.Mb(1,"ion-select-option",33),b.mc(2),b.Xb(3,"translate"),b.Lb(),b.Jb()),2&e){const e=t.$implicit;b.xb(1),b.dc("value",e),b.xb(1),b.nc(b.Yb(3,2,"TABS.OVERVIEW.CALENDAR_INTERVALS."+e))}}function f(e,t){if(1&e&&(b.Kb(0),b.Mb(1,"ion-select-option",33),b.mc(2),b.Xb(3,"translate"),b.Lb(),b.Jb()),2&e){const e=t.$implicit;b.xb(1),b.dc("value",e),b.xb(1),b.nc(b.Yb(3,2,"TABS.OVERVIEW.CALENDAR_INTERVALS."+e))}}function I(e,t){if(1&e&&(b.Kb(0),b.Mb(1,"ion-select-option",33),b.mc(2),b.Xb(3,"translate"),b.Lb(),b.Jb()),2&e){const e=t.$implicit;b.xb(1),b.dc("value",e),b.xb(1),b.nc(b.Yb(3,2,"TABS.OVERVIEW.CALENDAR_INTERVALS."+e))}}function S(e,t){if(1&e&&(b.Kb(0),b.Mb(1,"ion-select-option",33),b.mc(2),b.Xb(3,"translate"),b.Lb(),b.Jb()),2&e){const e=t.$implicit;b.xb(1),b.dc("value",e),b.xb(1),b.nc(b.Yb(3,2,"TABS.OVERVIEW.CALENDAR_INTERVALS."+e))}}function v(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-button",34),b.Ub("click",(function(){return b.hc(e),b.Wb().showDeleteConfirmationModal()})),b.mc(1),b.Xb(2,"translate"),b.Lb()}2&e&&(b.xb(1),b.nc(b.Yb(2,1,"TABS.OVERVIEW.REMOVE_SUBSCRIPTION")))}let x=(()=>{class e{constructor(e,t,i,n,r){this.alertController=e,this.modalController=t,this.formBuilder=i,this.storageService=n,this.translateService=r,this.availableBillingIntervals=l,this.colors=c,this.subscriptionForm=this.formBuilder.group({name:["",o.k.required],description:[""],cost:["",o.k.required],color:["BLUE",o.k.required],billingStart:[(new Date).toISOString().slice(0,10),o.k.required],billingEvery:[1,o.k.required],billingInterval:["MONTHS",o.k.required],contractStart:[(new Date).toISOString().slice(0,10),o.k.required],minimumContractDuration:[2,o.k.required],minimumContractDurationInterval:["YEARS",o.k.required],extensionAfterMinimumContractDurationEvery:[6,o.k.required],extensionAfterMinimumContractDurationInterval:["MONTHS",o.k.required],cancelationPeriodEvery:[3],cancelationPeriodInterval:["MONTHS"],notificationBeforeCancelationPeriodInDays:[null]})}ngOnInit(){this.existingSubscription?this.fillFormWithExistingEntry():this.retrieveSettingsFromStorage().then(()=>{this.fillNotificationBeforeCancelationPeriodInDays()})}ionViewDidEnter(){this.existingSubscription||this.focusNameInput()}save(){if(this.subscriptionForm.valid){const e=this.subscriptionForm.value;this.existingSubscription&&(e.id=this.existingSubscription.id),this.modalController.dismiss({entry:e})}else Object.values(this.subscriptionForm.controls).forEach(e=>{e.markAsTouched()})}delete(){this.modalController.dismiss({delete:!0,entry:this.existingSubscription})}showDeleteConfirmationModal(){return Object(a.a)(this,void 0,void 0,(function*(){const e={};this.translateService.get("GENERAL.CANCEL").subscribe(t=>{e.cancel=t}),this.translateService.get("GENERAL.OK").subscribe(t=>{e.ok=t}),this.translateService.get("TABS.OVERVIEW.REMOVE_SUBSCRIPTION_ALERT_HEADER").subscribe(t=>{e.header=t}),this.translateService.get("TABS.OVERVIEW.REMOVE_SUBSCRIPTION_ALERT_MESSAGE").subscribe(t=>{e.message=t});const t=yield this.alertController.create({cssClass:"alert-full-width",header:e.header,message:e.message,buttons:[{text:e.cancel,role:"cancel",cssClass:"secondary"},{text:e.ok,handler:()=>{this.delete()}}]});yield t.present()}))}dismiss(){this.modalController.dismiss()}retrieveSettingsFromStorage(){return Object(a.a)(this,void 0,void 0,(function*(){this.retrievedSettings=yield this.storageService.retrieveSettingsFromStorage()}))}fillFormWithExistingEntry(){Object.keys(this.subscriptionForm.controls).forEach(e=>{this.subscriptionForm.patchValue({[e]:this.existingSubscription[e]})})}fillNotificationBeforeCancelationPeriodInDays(){this.retrievedSettings&&this.subscriptionForm.patchValue({notificationBeforeCancelationPeriodInDays:this.retrievedSettings.notificationBeforeCancelationPeriodInDays})}focusNameInput(){setTimeout(()=>{this.nameInput.setFocus()},100)}}return e.\u0275fac=function(t){return new(t||e)(b.Hb(n.a),b.Hb(n.I),b.Hb(o.a),b.Hb(u.a),b.Hb(d.d))},e.\u0275cmp=b.Bb({type:e,selectors:[["app-modal-add-subscription"]],viewQuery:function(e,t){var i;1&e&&b.sc(m,!0),2&e&&b.fc(i=b.Vb())&&(t.nameInput=i.first)},inputs:{existingSubscription:"existingSubscription"},decls:124,vars:98,consts:[[3,"translucent"],[4,"ngIf","ngIfElse"],["updateMode",""],["slot","end"],["color","primary",3,"click"],["slot","icon-only","md","save"],["slot","icon-only","md","close"],[3,"fullscreen"],[3,"formGroup"],[1,"list-header"],["type","text","name","name","formControlName","name",2,"text-align","end"],["nameInput",""],["type","text","name","description","formControlName","description",2,"text-align","end"],["type","number","name","cost","value","3","formControlName","cost",2,"text-align","end"],[3,"color"],["name","color","formControlName","color","placeholder","Farbe",3,"cancelText","okText"],[4,"ngFor","ngForOf"],[1,"list-header",2,"margin-top","1rem"],["displayFormat","DD.MM.YYYY","name","billingStart","formControlName","billingStart",3,"cancelText","doneText"],[1,"ion-no-padding"],["size","8",1,"ion-no-padding"],["type","number","name","billingEvery","formControlName","billingEvery",2,"text-align","end"],["name","billingInterval","formControlName","billingInterval","placeholder","Intervall",1,"select-full-width",3,"cancelText","okText"],["displayFormat","DD.MM.YYYY","name","billingStart","formControlName","contractStart",3,"cancelText","doneText"],["type","number","name","minimumContractDuration","formControlName","minimumContractDuration",2,"text-align","end"],["name","minimumContractDurationInterval","formControlName","minimumContractDurationInterval","placeholder","Intervall",1,"select-full-width",3,"cancelText","okText"],["type","number","name","extensionAfterMinimumContractDurationEvery","formControlName","extensionAfterMinimumContractDurationEvery",2,"text-align","end"],["name","extensionAfterMinimumContractDurationInterval","formControlName","extensionAfterMinimumContractDurationInterval","placeholder","Intervall",1,"select-full-width",3,"cancelText","okText"],["type","number","name","cancelationPeriodEvery","formControlName","cancelationPeriodEvery",2,"text-align","end"],["name","cancelationPeriodInterval","formControlName","cancelationPeriodInterval","placeholder","Intervall",1,"select-full-width",3,"cancelText","okText"],["position","floating"],["type","number","name","notificationBeforeCancelationPeriodInDays","formControlName","notificationBeforeCancelationPeriodInDays"],["expand","block","size","large","color","danger","style","padding-left: 8px; padding-right: 8px; font-size: medium;",3,"click",4,"ngIf"],[3,"value"],["expand","block","size","large","color","danger",2,"padding-left","8px","padding-right","8px","font-size","medium",3,"click"]],template:function(e,t){if(1&e&&(b.Mb(0,"ion-header",0),b.Mb(1,"ion-toolbar"),b.Mb(2,"ion-title"),b.kc(3,p,3,3,"ng-container",1),b.kc(4,h,2,3,"ng-template",null,2,b.lc),b.Lb(),b.Mb(6,"ion-buttons",3),b.Mb(7,"ion-button",4),b.Ub("click",(function(){return t.save()})),b.Ib(8,"ion-icon",5),b.Lb(),b.Mb(9,"ion-button",4),b.Ub("click",(function(){return t.dismiss()})),b.Ib(10,"ion-icon",6),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(11,"ion-content",7),b.Mb(12,"form",8),b.Mb(13,"ion-list"),b.Mb(14,"ion-list-header",9),b.mc(15),b.Xb(16,"translate"),b.Lb(),b.Mb(17,"ion-item"),b.Mb(18,"ion-label"),b.mc(19),b.Xb(20,"translate"),b.Lb(),b.Ib(21,"ion-input",10,11),b.Lb(),b.Mb(23,"ion-item"),b.Mb(24,"ion-label"),b.mc(25),b.Xb(26,"translate"),b.Lb(),b.Ib(27,"ion-input",12),b.Lb(),b.Mb(28,"ion-item"),b.Mb(29,"ion-label"),b.mc(30),b.Xb(31,"translate"),b.Lb(),b.Ib(32,"ion-input",13),b.Lb(),b.Mb(33,"ion-item",14),b.Xb(34,"lowercase"),b.Mb(35,"ion-label"),b.mc(36),b.Xb(37,"translate"),b.Lb(),b.Mb(38,"ion-select",15),b.Xb(39,"translate"),b.Xb(40,"translate"),b.kc(41,g,5,6,"ng-container",16),b.Lb(),b.Lb(),b.Mb(42,"ion-list-header",17),b.mc(43),b.Xb(44,"translate"),b.Lb(),b.Mb(45,"ion-item"),b.Mb(46,"ion-label"),b.mc(47),b.Xb(48,"translate"),b.Lb(),b.Ib(49,"ion-datetime",18),b.Xb(50,"translate"),b.Xb(51,"translate"),b.Lb(),b.Mb(52,"ion-grid",19),b.Mb(53,"ion-row",19),b.Mb(54,"ion-col",20),b.Mb(55,"ion-item"),b.Mb(56,"ion-label"),b.mc(57),b.Xb(58,"translate"),b.Lb(),b.Ib(59,"ion-input",21),b.Lb(),b.Lb(),b.Mb(60,"ion-col",19),b.Mb(61,"ion-item"),b.Mb(62,"ion-select",22),b.Xb(63,"translate"),b.Xb(64,"translate"),b.kc(65,E,4,4,"ng-container",16),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(66,"ion-list-header",17),b.mc(67),b.Xb(68,"translate"),b.Lb(),b.Mb(69,"ion-item"),b.Mb(70,"ion-label"),b.mc(71),b.Xb(72,"translate"),b.Lb(),b.Ib(73,"ion-datetime",23),b.Xb(74,"translate"),b.Xb(75,"translate"),b.Lb(),b.Mb(76,"ion-grid",19),b.Mb(77,"ion-row",19),b.Mb(78,"ion-col",20),b.Mb(79,"ion-item"),b.Mb(80,"ion-label"),b.mc(81),b.Xb(82,"translate"),b.Lb(),b.Ib(83,"ion-input",24),b.Lb(),b.Lb(),b.Mb(84,"ion-col",19),b.Mb(85,"ion-item"),b.Mb(86,"ion-select",25),b.Xb(87,"translate"),b.Xb(88,"translate"),b.kc(89,f,4,4,"ng-container",16),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(90,"ion-grid",19),b.Mb(91,"ion-row",19),b.Mb(92,"ion-col",20),b.Mb(93,"ion-item"),b.Mb(94,"ion-label"),b.mc(95),b.Xb(96,"translate"),b.Lb(),b.Ib(97,"ion-input",26),b.Lb(),b.Lb(),b.Mb(98,"ion-col",19),b.Mb(99,"ion-item"),b.Mb(100,"ion-select",27),b.Xb(101,"translate"),b.Xb(102,"translate"),b.kc(103,I,4,4,"ng-container",16),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(104,"ion-grid",19),b.Mb(105,"ion-row",19),b.Mb(106,"ion-col",20),b.Mb(107,"ion-item"),b.Mb(108,"ion-label"),b.mc(109),b.Xb(110,"translate"),b.Lb(),b.Ib(111,"ion-input",28),b.Lb(),b.Lb(),b.Mb(112,"ion-col",19),b.Mb(113,"ion-item"),b.Mb(114,"ion-select",29),b.Xb(115,"translate"),b.Xb(116,"translate"),b.kc(117,S,4,4,"ng-container",16),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(118,"ion-item"),b.Mb(119,"ion-label",30),b.mc(120),b.Xb(121,"translate"),b.Lb(),b.Ib(122,"ion-input",31),b.Lb(),b.Lb(),b.Lb(),b.kc(123,v,3,3,"ion-button",32),b.Lb()),2&e){const e=b.gc(5);b.dc("translucent",!0),b.xb(3),b.dc("ngIf",!t.existingSubscription)("ngIfElse",e),b.xb(8),b.dc("fullscreen",!0),b.xb(1),b.dc("formGroup",t.subscriptionForm),b.xb(3),b.oc(" ",b.Yb(16,40,"TABS.OVERVIEW.GENERAL_INFORMATION")," "),b.xb(4),b.nc(b.Yb(20,42,"TABS.OVERVIEW.NAME")),b.xb(6),b.nc(b.Yb(26,44,"TABS.OVERVIEW.DESCRIPTION")),b.xb(5),b.nc(b.Yb(31,46,"TABS.OVERVIEW.COSTS")),b.xb(3),b.dc("color",b.Yb(34,48,t.subscriptionForm.value.color)),b.xb(3),b.nc(b.Yb(37,50,"TABS.OVERVIEW.TILE_COLOR")),b.xb(2),b.ec("cancelText",b.Yb(39,52,"GENERAL.CANCEL")),b.ec("okText",b.Yb(40,54,"GENERAL.OK")),b.xb(3),b.dc("ngForOf",t.colors),b.xb(2),b.oc(" ",b.Yb(44,56,"TABS.OVERVIEW.BILLING")," "),b.xb(4),b.nc(b.Yb(48,58,"TABS.OVERVIEW.BILLING_START")),b.xb(2),b.ec("cancelText",b.Yb(50,60,"GENERAL.CANCEL")),b.ec("doneText",b.Yb(51,62,"GENERAL.DONE")),b.xb(8),b.nc(b.Yb(58,64,"TABS.OVERVIEW.BILLING_EVERY")),b.xb(5),b.ec("cancelText",b.Yb(63,66,"GENERAL.CANCEL")),b.ec("okText",b.Yb(64,68,"GENERAL.OK")),b.xb(3),b.dc("ngForOf",t.availableBillingIntervals),b.xb(2),b.oc(" ",b.Yb(68,70,"TABS.OVERVIEW.CONTRACT")," "),b.xb(4),b.nc(b.Yb(72,72,"TABS.OVERVIEW.CONTRACT_START")),b.xb(2),b.ec("cancelText",b.Yb(74,74,"GENERAL.CANCEL")),b.ec("doneText",b.Yb(75,76,"GENERAL.DONE")),b.xb(8),b.nc(b.Yb(82,78,"TABS.OVERVIEW.MINIMUM_CONTRACT_DURATION")),b.xb(5),b.ec("cancelText",b.Yb(87,80,"GENERAL.CANCEL")),b.ec("okText",b.Yb(88,82,"GENERAL.OK")),b.xb(3),b.dc("ngForOf",t.availableBillingIntervals),b.xb(6),b.nc(b.Yb(96,84,"TABS.OVERVIEW.EXTENSION_AFTER_MINIMUM_CONTRACT_DURATION")),b.xb(5),b.ec("cancelText",b.Yb(101,86,"GENERAL.CANCEL")),b.ec("okText",b.Yb(102,88,"GENERAL.OK")),b.xb(3),b.dc("ngForOf",t.availableBillingIntervals),b.xb(6),b.nc(b.Yb(110,90,"TABS.OVERVIEW.CANCELATION_PERIOD")),b.xb(5),b.ec("cancelText",b.Yb(115,92,"GENERAL.CANCEL")),b.ec("okText",b.Yb(116,94,"GENERAL.OK")),b.xb(3),b.dc("ngForOf",t.availableBillingIntervals),b.xb(3),b.nc(b.Yb(121,96,"TABS.OVERVIEW.NOTIFICATION_BEFORE_CANCELATION_PERIOD_IN_DAYS")),b.xb(3),b.dc("ngIf",t.existingSubscription)}},directives:[n.o,n.F,n.E,r.l,n.e,n.d,n.p,n.k,o.l,o.h,o.c,n.t,n.u,n.r,n.s,n.q,n.M,o.g,o.b,n.J,n.z,n.L,r.k,n.l,n.n,n.x,n.j,n.A],pipes:[d.c,r.j,r.q],styles:[""]}),e})();var L=i("B+sD");let T=(()=>{class e{constructor(){this.MS_PER_DAY=864e5}transform(e){const t=new Date,i=new Date(e.billingStart);if(0===e.billingEvery)return null;switch(e.billingInterval){case"DAYS":for(;this.dateDiffInDays(t,i)<=0;)i.setDate(i.getDate()+e.billingEvery);break;case"WEEKS":for(;this.dateDiffInDays(t,i)<=0;)i.setDate(i.getDate()+7*e.billingEvery);break;case"MONTHS":for(;this.dateDiffInDays(t,i)<=0;)i.setMonth(i.getMonth()+e.billingEvery);break;case"YEARS":for(;this.dateDiffInDays(t,i)<=0;)i.setFullYear(i.getFullYear()+e.billingEvery);break;default:return null}return{dueDate:i,inDaysFromToday:this.dateDiffInDays(t,i)}}absDateDiffInDays(e,t){return Math.abs(this.dateDiffInDays(e,t))}dateDiffInDays(e,t){const i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate());return Math.floor((n-i)/this.MS_PER_DAY)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=b.Gb({name:"nextBilling",type:e,pure:!0}),e})();var y=i("4z8+"),B=i("jv0y");let M=(()=>{class e{transform(e,t){let i;if(0===e.billingEvery)return 0;switch(e.billingInterval){case"DAYS":i=e.cost/e.billingEvery;break;case"WEEKS":i=e.cost/e.billingEvery/7;break;case"MONTHS":if("YEARS"===t)return e.cost/e.billingEvery*12;i=e.cost/e.billingEvery/30;break;case"YEARS":if("MONTHS"===t)return e.cost/e.billingEvery/12;i=e.cost/e.billingEvery/365;break;default:return null}switch(t){case"DAYS":return i;case"WEEKS":return 7*i;case"MONTHS":return 30*i;case"YEARS":return 365*i;default:return null}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=b.Gb({name:"costByBillingInterval",type:e,pure:!0}),e})();function A(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-chip",6),b.Ub("click",(function(t){b.hc(e);const i=b.Wb();return i.explainNextBilling(t,i.subscription)})),b.Ib(1,"ion-icon",7),b.Mb(2,"ion-label",8),b.mc(3),b.Xb(4,"nextBilling"),b.Xb(5,"slice"),b.Xb(6,"titlecase"),b.Xb(7,"translate"),b.Lb(),b.Lb()}if(2&e){const e=b.Wb();b.xb(3),b.pc("",b.Yb(4,2,e.subscription).inDaysFromToday," ",b.ac(5,4,b.Yb(6,8,b.Yb(7,10,"TABS.OVERVIEW.CALENDAR_INTERVALS.DAYS")),0,1),"")}}function N(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-chip",9),b.Ub("click",(function(t){b.hc(e);const i=b.Wb();return i.explainNextCancelationPeriodDeadline(t,i.subscription)})),b.Ib(1,"ion-icon",10),b.Mb(2,"ion-label",8),b.mc(3),b.Xb(4,"nextCancelationPeriodDeadline"),b.Xb(5,"slice"),b.Xb(6,"titlecase"),b.Xb(7,"translate"),b.Lb(),b.Lb()}if(2&e){const e=b.Wb();b.xb(3),b.pc("",b.Yb(4,2,e.subscription).inDaysFromToday," ",b.ac(5,4,b.Yb(6,8,b.Yb(7,10,"TABS.OVERVIEW.CALENDAR_INTERVALS.DAYS")),0,1),"")}}function C(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-chip",9),b.Ub("click",(function(t){b.hc(e);const i=b.Wb();return i.explainAlarmForNextCancelationPeriodDeadline(t,i.subscription)})),b.Ib(1,"ion-icon",11),b.Ib(2,"ion-label",8),b.Lb()}}let D=(()=>{class e{constructor(e,t,i,n,r){this.toastController=e,this.nextBillingPipe=t,this.nextCancelationPeriodDeadlinePipe=i,this.notificationTimeForNextCancelationPeriodDeadlinePipe=n,this.translateService=r}explainNextBilling(e,t){e.stopPropagation();const i=this.nextBillingPipe.transform(t).inDaysFromToday,n=new r.d(this.translateService.currentLang).transform(this.nextBillingPipe.transform(t).dueDate);this.translateService.get("TABS.OVERVIEW.DAYS_UNTIL_NEXT_BILLING_ON_HELPER").subscribe(e=>{this.toastMessage(i+" "+e+" "+n)})}explainNextCancelationPeriodDeadline(e,t){e.stopPropagation();const i=this.nextCancelationPeriodDeadlinePipe.transform(t).inDaysFromToday,n=new r.d(this.translateService.currentLang).transform(this.nextCancelationPeriodDeadlinePipe.transform(t).dueDate);this.translateService.get("TABS.OVERVIEW.DAYS_UNTIL_NEXT_CANCELATION_PERIOD_DEADLINE_ON_HELPER").subscribe(e=>{this.toastMessage(i+" "+e+" "+n)})}explainAlarmForNextCancelationPeriodDeadline(e,t){e.stopPropagation();const i=new r.d(this.translateService.currentLang).transform(this.notificationTimeForNextCancelationPeriodDeadlinePipe.transform(t).dueDate);this.translateService.get("TABS.OVERVIEW.NOTIFICATION_BEFORE_CANCELATION_PERIOD_STARTS_ON").subscribe(e=>{this.toastMessage(e+" "+i)})}toastMessage(e){return Object(a.a)(this,void 0,void 0,(function*(){(yield this.toastController.create({cssClass:"toast-center-text",message:e,duration:3e3})).present()}))}}return e.\u0275fac=function(t){return new(t||e)(b.Hb(n.N),b.Hb(T),b.Hb(y.a),b.Hb(B.a),b.Hb(d.d))},e.\u0275cmp=b.Bb({type:e,selectors:[["app-subscription-card"]],inputs:{subscription:"subscription",selectedBillingInterval:"selectedBillingInterval",currency:"currency"},decls:30,vars:47,consts:[["button","",3,"color"],[1,"ion-no-padding"],["size","auto",1,"ion-no-padding"],["style","margin-left: 0","size","small",3,"click",4,"ngIf"],["size","small",3,"click",4,"ngIf"],["size","auto",1,"ion-no-padding",2,"margin","auto"],["size","small",2,"margin-left","0",3,"click"],["name","card","color","light"],["color","light"],["size","small",3,"click"],["name","warning","color","light"],["name","notifications","color","light",2,"margin-inline-end","-4px"]],template:function(e,t){1&e&&(b.Mb(0,"ion-card",0),b.Xb(1,"lowercase"),b.Mb(2,"ion-card-content"),b.Mb(3,"ion-grid",1),b.Mb(4,"ion-row",1),b.Mb(5,"ion-col",1),b.mc(6),b.Lb(),b.Mb(7,"ion-col",2),b.Mb(8,"b"),b.mc(9),b.Xb(10,"number"),b.Xb(11,"costByBillingInterval"),b.Xb(12,"slice"),b.Xb(13,"titlecase"),b.Xb(14,"translate"),b.Lb(),b.Lb(),b.Lb(),b.Mb(15,"ion-row",1),b.Mb(16,"ion-col",1),b.kc(17,A,8,12,"ion-chip",3),b.Xb(18,"nextBilling"),b.kc(19,N,8,12,"ion-chip",4),b.Xb(20,"nextCancelationPeriodDeadline"),b.kc(21,C,3,0,"ion-chip",4),b.Xb(22,"notificationTimeForNextCancelationPeriodDeadline"),b.Lb(),b.Mb(23,"ion-col",5),b.Mb(24,"small"),b.mc(25),b.Xb(26,"number"),b.Xb(27,"slice"),b.Xb(28,"titlecase"),b.Xb(29,"translate"),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb()),2&e&&(b.dc("color",b.Yb(1,12,t.subscription.color)),b.xb(6),b.oc(" ",t.subscription.name," "),b.xb(3),b.qc("",b.ac(10,14,b.Zb(11,18,t.subscription,t.selectedBillingInterval),"1.2-2",t.translateService.currentLang)," ",t.currency||"\u20ac"," / ",b.ac(12,21,b.Yb(13,25,b.Yb(14,27,"TABS.OVERVIEW.CALENDAR_INTERVALS."+t.selectedBillingInterval)),0,1),""),b.xb(8),b.dc("ngIf",b.Yb(18,29,t.subscription)),b.xb(2),b.dc("ngIf",b.Yb(20,31,t.subscription)),b.xb(2),b.dc("ngIf",b.Yb(22,33,t.subscription)),b.xb(4),b.rc("",b.ac(26,35,t.subscription.cost,"1.2-2",t.translateService.currentLang)," ",t.currency||"\u20ac"," / ",t.subscription.billingEvery," ",b.ac(27,39,b.Yb(28,43,b.Yb(29,45,"TABS.OVERVIEW.CALENDAR_INTERVALS."+t.subscription.billingInterval)),0,1),""))},directives:[n.f,n.g,n.n,n.x,n.j,r.l,n.i,n.p,n.s],pipes:[r.j,r.e,M,r.o,r.p,d.c,T,y.a,B.a],styles:[""]}),e})(),O=(()=>{class e{constructor(e,t,i){this.costByBillingIntervalPipe=e,this.nextBillingPipe=t,this.nextCancelationPeriodDeadlinePipe=i,this.availableBillingIntervals=l}transform(e,t){if(!e)return null;if(!t)return e;switch(t){case"nameAsc":return e.sort(this.sortByNameAsc);case"nameDesc":return e.sort(this.sortByNameDesc);case"costAsc":return e.sort((e,t)=>this.costByBillingIntervalPipe.transform(e,this.availableBillingIntervals[0])<this.costByBillingIntervalPipe.transform(t,this.availableBillingIntervals[0])?-1:this.costByBillingIntervalPipe.transform(e,this.availableBillingIntervals[0])>this.costByBillingIntervalPipe.transform(t,this.availableBillingIntervals[0])?1:0);case"costDesc":return e.sort((e,t)=>this.costByBillingIntervalPipe.transform(e,this.availableBillingIntervals[0])>this.costByBillingIntervalPipe.transform(t,this.availableBillingIntervals[0])?-1:this.costByBillingIntervalPipe.transform(e,this.availableBillingIntervals[0])<this.costByBillingIntervalPipe.transform(t,this.availableBillingIntervals[0])?1:0);case"nextBillingAsc":return e.sort((e,t)=>this.nextBillingPipe.transform(e).inDaysFromToday<this.nextBillingPipe.transform(t).inDaysFromToday?-1:this.nextBillingPipe.transform(e).inDaysFromToday>this.nextBillingPipe.transform(t).inDaysFromToday?1:0);case"nextBillingDesc":return e.sort((e,t)=>this.nextBillingPipe.transform(e).inDaysFromToday>this.nextBillingPipe.transform(t).inDaysFromToday?-1:this.nextBillingPipe.transform(e).inDaysFromToday<this.nextBillingPipe.transform(t).inDaysFromToday?1:0);case"nextContractExtensionAsc":return e.sort((e,t)=>this.nextCancelationPeriodDeadlinePipe.transform(e).inDaysFromToday<this.nextCancelationPeriodDeadlinePipe.transform(t).inDaysFromToday?-1:this.nextCancelationPeriodDeadlinePipe.transform(e).inDaysFromToday>this.nextCancelationPeriodDeadlinePipe.transform(t).inDaysFromToday?1:0);case"nextContractExtensionDesc":return e.sort((e,t)=>this.nextCancelationPeriodDeadlinePipe.transform(e).inDaysFromToday>this.nextCancelationPeriodDeadlinePipe.transform(t).inDaysFromToday?-1:this.nextCancelationPeriodDeadlinePipe.transform(e).inDaysFromToday<this.nextCancelationPeriodDeadlinePipe.transform(t).inDaysFromToday?1:0);default:return e}}sortByNameAsc(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0}sortByNameDesc(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?1:e.name.toLowerCase()>t.name.toLowerCase()?-1:0}}return e.\u0275fac=function(t){return new(t||e)(b.Hb(M),b.Hb(T),b.Hb(y.a))},e.\u0275pipe=b.Gb({name:"sortSubscriptions",type:e,pure:!0}),e})(),R=(()=>{class e{transform(e,t){return t?e.filter(e=>{var i;return e.name.toLowerCase().includes(t.toLowerCase())||(null===(i=e.description)||void 0===i?void 0:i.toLowerCase().includes(t.toLowerCase()))}):e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=b.Gb({name:"searchSubscriptions",type:e,pure:!0}),e})(),V=(()=>{class e{constructor(e){this.costByBillingIntervalPipe=e}transform(e,t){let i=0;if(!e)return i;for(const n of e)i+=this.costByBillingIntervalPipe.transform(n,t);return i}}return e.\u0275fac=function(t){return new(t||e)(b.Hb(M))},e.\u0275pipe=b.Gb({name:"totalCostByBillingInterval",type:e,pure:!1}),e})();const P=["searchSubscriptions"];function Y(e,t){1&e&&(b.Kb(0),b.mc(1),b.Xb(2,"translate"),b.Jb()),2&e&&(b.xb(1),b.oc(" ",b.Yb(2,1,"TABS.OVERVIEW.OVERVIEW")," "))}function k(e,t){if(1&e&&(b.Kb(0),b.mc(1),b.Xb(2,"number"),b.Xb(3,"totalCostByBillingInterval"),b.Xb(4,"searchSubscriptions"),b.Xb(5,"slice"),b.Xb(6,"titlecase"),b.Xb(7,"translate"),b.Jb()),2&e){const e=b.Wb();b.xb(1),b.qc(" ",b.ac(2,3,b.Zb(3,7,b.Zb(4,10,e.subscriptions,e.subscriptionSearchFilter),e.selectedBillingInterval),"1.2-2",e.translateService.currentLang)," ",(null==e.settings?null:e.settings.currency)||"\u20ac"," / ",b.ac(5,13,b.Yb(6,17,b.Yb(7,19,"TABS.OVERVIEW.CALENDAR_INTERVALS."+e.selectedBillingInterval)),0,1)," ")}}function X(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-card"),b.Mb(1,"ion-card-content",12),b.Mb(2,"ion-searchbar",13,14),b.Ub("ngModelChange",(function(t){return b.hc(e),b.Wb().subscriptionSearchFilter=t})),b.Xb(4,"translate"),b.Lb(),b.Lb(),b.Lb()}if(2&e){const e=b.Wb();b.xb(2),b.ec("placeholder",b.Yb(4,2,"TABS.OVERVIEW.SEARCH_FOR_NAME_AND_DESCRIPTION")),b.dc("ngModel",e.subscriptionSearchFilter)}}function F(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-card"),b.Mb(1,"ion-item"),b.Mb(2,"ion-label"),b.mc(3),b.Xb(4,"translate"),b.Lb(),b.Mb(5,"ion-button",15),b.Ub("click",(function(){return b.hc(e),b.Wb().dismissHelperText("hideOverviewHelperTextGeneral")})),b.Ib(6,"ion-icon",16),b.Lb(),b.Lb(),b.Mb(7,"ion-card-content"),b.mc(8),b.Xb(9,"translate"),b.Lb(),b.Lb()}2&e&&(b.xb(3),b.nc(b.Yb(4,2,"TABS.OVERVIEW.NO_SUBSCRIPTION_HEADER")),b.xb(5),b.oc(" ",b.Yb(9,4,"TABS.OVERVIEW.NO_SUBSCRIPTION_TEXT")," "))}function _(e,t){if(1&e){const e=b.Nb();b.Mb(0,"ion-card"),b.Mb(1,"ion-item"),b.Mb(2,"ion-label"),b.mc(3),b.Xb(4,"translate"),b.Lb(),b.Mb(5,"ion-button",15),b.Ub("click",(function(){return b.hc(e),b.Wb().dismissHelperText("hideOverviewHelperTextMenuBar")})),b.Ib(6,"ion-icon",16),b.Lb(),b.Lb(),b.Mb(7,"ion-card-content"),b.Mb(8,"ion-grid",12),b.Mb(9,"ion-row",17),b.Mb(10,"ion-col",18),b.Mb(11,"ion-fab-button",19),b.Ib(12,"ion-icon",20),b.Lb(),b.Lb(),b.Mb(13,"ion-col",21),b.mc(14),b.Xb(15,"translate"),b.Lb(),b.Lb(),b.Mb(16,"ion-row",17),b.Mb(17,"ion-col",18),b.Mb(18,"ion-fab-button",19),b.Ib(19,"ion-icon",22),b.Lb(),b.Lb(),b.Mb(20,"ion-col",21),b.mc(21),b.Xb(22,"translate"),b.Lb(),b.Lb(),b.Mb(23,"ion-row",17),b.Mb(24,"ion-col",18),b.Mb(25,"ion-fab-button",19),b.Ib(26,"ion-icon",23),b.Lb(),b.Lb(),b.Mb(27,"ion-col",21),b.mc(28),b.Xb(29,"translate"),b.Lb(),b.Lb(),b.Mb(30,"ion-row",17),b.Mb(31,"ion-col",18),b.Mb(32,"ion-fab-button",19),b.Ib(33,"ion-icon",24),b.Lb(),b.Lb(),b.Mb(34,"ion-col",21),b.mc(35),b.Xb(36,"translate"),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Lb()}2&e&&(b.xb(3),b.nc(b.Yb(4,5,"TABS.OVERVIEW.MENU_BUTTONS_HELPER_HEADER")),b.xb(11),b.oc(" ",b.Yb(15,7,"TABS.OVERVIEW.SEARCH_HELPER")," "),b.xb(7),b.oc(" ",b.Yb(22,9,"TABS.OVERVIEW.CHANGE_CHOOSEN_BILLING_INTERVAL_HELPER")," "),b.xb(7),b.oc(" ",b.Yb(29,11,"TABS.OVERVIEW.SORT_HELPER")," "),b.xb(7),b.oc(" ",b.Yb(36,13,"TABS.OVERVIEW.ADD_SUBSCRIPTION_HELPER")," "))}function w(e,t){if(1&e){const e=b.Nb();b.Kb(0),b.Mb(1,"app-subscription-card",25),b.Ub("click",(function(){b.hc(e);const i=t.$implicit;return b.Wb().presentUpdateSubscriptionModal(i)})),b.Lb(),b.Jb()}if(2&e){const e=t.$implicit,i=b.Wb();b.xb(1),b.dc("subscription",e)("selectedBillingInterval",i.selectedBillingInterval)("currency",null==i.settings?null:i.settings.currency)}}const W=[{path:"",component:(()=>{class e{constructor(e,t,i,n,r){this.alertController=e,this.modalController=t,this.storageService=i,this.translateService=n,this.notificationService=r,this.subscriptions=[],this.availableBillingIntervals=l,this.subscriptionSearchFilter="",this.isSearchbarEnabled=!1}ionViewWillEnter(){this.retrieveSettingsFromStorage(),this.retrieveSubscriptionsFromStorage()}addEntry(e){let t=1;for(;this.subscriptions.some(e=>e.id===t);)t++;e.id=t,this.subscriptions.push(e),this.saveSubscriptionsToStorage()}updateEntry(e){const t=this.subscriptions.findIndex(t=>t.id===e.id);this.subscriptions[t]=e,this.saveSubscriptionsToStorage()}deleteEntry(e){this.subscriptions=this.subscriptions.filter(t=>t.id!==e.id),this.saveSubscriptionsToStorage()}saveSubscriptionsToStorage(){return Object(a.a)(this,void 0,void 0,(function*(){yield this.storageService.saveSubscriptionsToStorage(this.subscriptions).then(()=>{this.notificationService.scheduleNotifications()})}))}retrieveSubscriptionsFromStorage(){return Object(a.a)(this,void 0,void 0,(function*(){this.subscriptions=yield this.storageService.retrieveSubscriptionsFromStorage()}))}presentAddSubscriptionModal(){return Object(a.a)(this,void 0,void 0,(function*(){const e=yield this.modalController.create({component:x});return e.onDidDismiss().then(e=>{e.data&&this.addEntry(e.data.entry)}),yield e.present()}))}presentUpdateSubscriptionModal(e){return Object(a.a)(this,void 0,void 0,(function*(){const t=yield this.modalController.create({component:x,componentProps:{existingSubscription:e}});return t.onDidDismiss().then(e=>{e.data&&(e.data.delete?this.deleteEntry(e.data.entry):this.updateEntry(e.data.entry))}),yield t.present()}))}changeChoosenBillingInterval(){if(this.selectedBillingInterval===this.availableBillingIntervals[this.availableBillingIntervals.length-1])this.selectedBillingInterval=this.availableBillingIntervals[0];else{const e=this.availableBillingIntervals.findIndex(e=>e===this.selectedBillingInterval);this.selectedBillingInterval=this.availableBillingIntervals[e+1]}this.settings.defaultBillingInterval=this.selectedBillingInterval,this.saveSettingsToStorage()}retrieveSettingsFromStorage(){return Object(a.a)(this,void 0,void 0,(function*(){this.settings=yield this.storageService.retrieveSettingsFromStorage(),this.selectedBillingInterval=this.settings.defaultBillingInterval||"MONTHS",this.sortSubscriptionsBy=this.settings.defaultSortBy||"nextBillingAsc"}))}saveSettingsToStorage(){return Object(a.a)(this,void 0,void 0,(function*(){this.storageService.saveSettingsToStorage(this.settings)}))}showSortingAlert(){return Object(a.a)(this,void 0,void 0,(function*(){const e={};this.translateService.get("TABS.OVERVIEW.SORT_BY").subscribe(t=>{e.header=t}),this.translateService.get("TABS.OVERVIEW.NAME").subscribe(t=>{e.name=t}),this.translateService.get("TABS.OVERVIEW.COSTS_PER_PERIOD").subscribe(t=>{e.costsPerPeriod=t}),this.translateService.get("TABS.OVERVIEW.NEXT_PAYMENT").subscribe(t=>{e.nextPayment=t}),this.translateService.get("TABS.OVERVIEW.NEXT_SUBSCRIPTION_EXTENSION").subscribe(t=>{e.nextSubscriptionExtension=t}),this.translateService.get("GENERAL.ASC").subscribe(t=>{e.asc=t}),this.translateService.get("GENERAL.DESC").subscribe(t=>{e.desc=t});const t=yield this.alertController.create({cssClass:"alert-full-width",header:e.header,inputs:[{name:"name",type:"radio",label:e.name,value:"name",checked:this.sortSubscriptionsBy.startsWith("name")},{name:"cost",type:"radio",label:e.costsPerPeriod,value:"cost",checked:this.sortSubscriptionsBy.startsWith("cost")},{name:"nextBilling",type:"radio",label:e.nextPayment,value:"nextBilling",checked:this.sortSubscriptionsBy.startsWith("nextBilling")},{name:"nextContractExtension",type:"radio",label:e.nextSubscriptionExtension,value:"nextContractExtension",checked:this.sortSubscriptionsBy.startsWith("nextContractExtension")}],buttons:[{text:e.asc+" \u2191",handler:e=>{this.sortSubscriptions(e+"Asc")}},{text:e.desc+" \u2193",handler:e=>{this.sortSubscriptions(e+"Desc")}}]});yield t.present()}))}sortSubscriptions(e){this.sortSubscriptionsBy=e,this.settings.defaultSortBy=e,this.saveSettingsToStorage()}dismissHelperText(e){if("hideOverviewHelperTextGeneral"===e)this.settings.hideOverviewHelperTextGeneral=!0;else{if("hideOverviewHelperTextMenuBar"!==e)return;this.settings.hideOverviewHelperTextMenuBar=!0}this.saveSettingsToStorage()}toggleSearchbarVisibility(){this.subscriptionSearchFilter="",this.isSearchbarEnabled=!this.isSearchbarEnabled,this.isSearchbarEnabled&&setTimeout(()=>{this.searchSubscriptions.setFocus()},100)}}return e.\u0275fac=function(t){return new(t||e)(b.Hb(n.a),b.Hb(n.I),b.Hb(u.a),b.Hb(d.d),b.Hb(L.a))},e.\u0275cmp=b.Bb({type:e,selectors:[["app-tab-overview"]],viewQuery:function(e,t){var i;1&e&&b.sc(P,!0),2&e&&b.fc(i=b.Vb())&&(t.searchSubscriptions=i.first)},decls:21,vars:18,consts:[[3,"translucent"],[4,"ngIf"],["slot","end"],["color","primary","shape","round",3,"disabled","fill","click"],["slot","icon-only","md","search"],["color","primary",3,"disabled","click"],["slot","icon-only","md","swap-horizontal"],["slot","icon-only","md","filter"],["color","primary",3,"click"],["slot","icon-only","md","add"],[3,"fullscreen"],[4,"ngFor","ngForOf"],[1,"ion-no-padding"],[1,"searchbar-integrate",3,"placeholder","ngModel","ngModelChange"],["searchSubscriptions",""],["fill","clear","slot","end",3,"click"],["name","close-outline"],[1,"ion-no-padding","ion-align-items-center"],["size","auto",1,"ion-no-padding"],["size","small"],["md","search"],[1,"ion-no-padding",2,"margin-left","1rem"],["md","swap-horizontal"],["md","filter"],["md","add"],[3,"subscription","selectedBillingInterval","currency","click"]],template:function(e,t){1&e&&(b.Mb(0,"ion-header",0),b.Mb(1,"ion-toolbar"),b.Mb(2,"ion-title"),b.kc(3,Y,3,3,"ng-container",1),b.kc(4,k,8,21,"ng-container",1),b.Lb(),b.Mb(5,"ion-buttons",2),b.Mb(6,"ion-button",3),b.Ub("click",(function(){return t.toggleSearchbarVisibility()})),b.Ib(7,"ion-icon",4),b.Lb(),b.Mb(8,"ion-button",5),b.Ub("click",(function(){return t.changeChoosenBillingInterval()})),b.Ib(9,"ion-icon",6),b.Lb(),b.Mb(10,"ion-button",5),b.Ub("click",(function(){return t.showSortingAlert()})),b.Ib(11,"ion-icon",7),b.Lb(),b.Mb(12,"ion-button",8),b.Ub("click",(function(){return t.presentAddSubscriptionModal()})),b.Ib(13,"ion-icon",9),b.Lb(),b.Lb(),b.Lb(),b.Lb(),b.Mb(14,"ion-content",10),b.kc(15,X,5,4,"ion-card",1),b.kc(16,F,10,6,"ion-card",1),b.kc(17,_,37,15,"ion-card",1),b.kc(18,w,2,3,"ng-container",11),b.Xb(19,"sortSubscriptions"),b.Xb(20,"searchSubscriptions"),b.Lb()),2&e&&(b.dc("translucent",!0),b.xb(3),b.dc("ngIf",0===t.subscriptions.length),b.xb(1),b.dc("ngIf",0!==t.subscriptions.length),b.xb(2),b.dc("disabled",t.subscriptions.length<2)("fill",t.isSearchbarEnabled?"outline":"clear"),b.xb(2),b.dc("disabled",t.subscriptions.length<2),b.xb(2),b.dc("disabled",t.subscriptions.length<2),b.xb(4),b.dc("fullscreen",!0),b.xb(1),b.dc("ngIf",t.isSearchbarEnabled),b.xb(1),b.dc("ngIf",!(null!=t.settings&&t.settings.hideOverviewHelperTextGeneral)),b.xb(1),b.dc("ngIf",!(null!=t.settings&&t.settings.hideOverviewHelperTextMenuBar)),b.xb(1),b.dc("ngForOf",b.Zb(19,12,b.Zb(20,15,t.subscriptions,t.subscriptionSearchFilter),t.sortSubscriptionsBy)))},directives:[n.o,n.F,n.E,r.l,n.e,n.d,n.p,n.k,r.k,n.f,n.g,n.y,n.M,o.g,o.i,n.r,n.s,n.n,n.x,n.j,n.m,D],pipes:[O,R,d.c,r.e,V,r.o,r.p],styles:[""]}),e})()}];let H=(()=>{class e{}return e.\u0275mod=b.Fb({type:e}),e.\u0275inj=b.Eb({factory:function(t){return new(t||e)},imports:[[s.i.forChild(W)],s.i]}),e})(),G=(()=>{class e{}return e.\u0275mod=b.Fb({type:e}),e.\u0275inj=b.Eb({factory:function(t){return new(t||e)},providers:[T,y.a,M,B.a],imports:[[n.G,r.b,H,o.d,o.j,d.b]]}),e})()}}]);